<% if ($.type(model) === 'object') { %>
<article>
    <header><strong>Node Details</strong></header>
    <section class="well well-small clearfix">
        <dl>
            <dt>Node IP:</dt><dd><% print(model.ip); %></dd>
            <dt>Hostname:</dt><dd><% print(model['host/name']); %></dd>
            <dt>Host Status:</dt><dd><% print(model['host/status']); %></dd>
            <dt>Agent Status:</dt><dd><% print(model['agent/status']); %></dd>
            <dt>Operating System:</dt><dd><% print(model['os/name']); %></dd>
        </dl>
    </section>
</article>
<article>
    <header><strong>Patches Available</strong></header>
    <% if(model['patch/need'].length != 0) { %>
        <section class="list">
            <form action="/submitForm" method="post" class="form-inline">
                <header class="clearfix">
                    <label class="checkbox inline">
                        <input type="checkbox" class="toggle-all">Select / Deselect All
                    </label>
                    <div class="btn-toolbar pull-right noMargin">
                        <div class="btn-group" data-toggle="buttons-radio">
                            <button type="button" class="btn btn-small active">Install</button>
                            <button type="button" class="btn btn-small">Hide</button>
                        </div>
                        <div class="btn-group">
                            <input type="submit" class="btn btn-small btn-primary disabled" value="Submit">
                        </div>
                    </div>
                    <input type="hidden" value="<% print(model.id); %>" name="node">
                </header>
                <% _.each(model['patch/need'], function (patch, i) { %>
                <div class="item clearfix">
                    <span class="desc">
                        <label class="checkbox">
                            <input type="checkbox" id="<%= patch %>" name="patches" value="<%= patch %>">
                            Patch ID: <%= patch %>
                        </label>
                    </span>
                    <span class="pull-right">
                        <a href="#patches/<%= patch %>">More information</a>
                    </span>
                </div>
                <% }); %>
            </form>
        </section>
    <% }  else { %>
        <section class="well noPadding">
            <small><em>No patches to display</em></small>
        </section>
    <% } %>
</article>
<article>
    <header><strong>Patches Done</strong></header><br>
    <% if(model['patch/done'].length != 0) { %>
        <form action="/submitForm" method="post">
            <div class="clearfix">
                <ul style="display: inline;">
                    <li style="display: inline;">
                        <span><input type="checkbox" onclick="toggleChecked(this);" style="margin-bottom: 5px">Select / Deselect All</span>
                    </li>
                    <li style="display: inline;">
                        <span class="pull-right">
                            <input type="hidden" value="<% print(model.id); %>" name="node">
                            <input type="submit" value="Submit">
                        </span>
                    </li>
                    <li style="display: inline;">
                        <span class="pull-right">
                            <select name="operation">
                                <option value="uninstall">Uninstall</option>
                                <option value="hide">Hide</option>
                            </select>&nbsp;&nbsp;
                        </span>
                    </li>
                    <li style="display: inline;"><span class="pull-right">Operation:&nbsp;&nbsp;</span></li>
                </ul>
            </div>
            <section class="well noPadding">
                <div class="list">
                    <% _.each(model['patch/done'], function (patch, i) { %>
                        <div class="item clearfix">
                            <span class="desc"><input type="checkbox" id="<%= patch %>" name="patches" value="<%= patch %>" style="margin-bottom: 5px">Patch ID: <%= patch %></span>
                            <span class="pull-right"><a href="#patches/<%= patch %>">More information</a></span>
                        </div>
                    <% }); %>
                </div>
            </section>
        </form>
    <% }  else { %>
        <section class="well noPadding">
            <small><em>No patches to display</em></small>
        </section>
    <% } %>
</article>
<article>
    <header><strong>Patches Pending</strong></header><br>
    <% if(model['patch/pend'].length != 0) { %>
        <section class="well noPadding">
            <div class="list">
                <% _.each(model['patch/pend'], function (patch, i) { %>
                    <div class="item clearfix">
                        <span class="desc">Patch ID: <%= patch %></span>
                        <span class="pull-right"><a href="#patches/<%= patch %>">More information</a></span>
                    </div>
                <% }); %>
            </div>
        </section>
    <% }  else { %>
        <section class="well noPadding">
            <small><em>No patches to display</em></small>
        </section>
    <% } %>
</article>
<article>
    <header><strong>Patches Failed</strong></header><br>
    <% if(model['patch/fail'].length != 0) { %>
    <form action="/submitForm" method="post">
        <div class="clearfix">
            <ul style="display: inline;">
                <li style="display: inline;">
                    <span><input type="checkbox" onclick="toggleChecked(this);" style="margin-bottom: 5px">Select / Deselect All</span>
                </li>
                <li style="display: inline;">
                    <span class="pull-right">
                        <input type="hidden" value="<% print(model.id); %>" name="node">
                        <input type="submit" value="Submit">
                    </span>
                </li>
                <li style="display: inline;">
                    <span class="pull-right">
                        <select name="operation">
                            <option value="install">Reinstall</option>
                            <option value="hide">Hide</option>
                        </select>&nbsp;&nbsp;
                    </span>
                </li>
                <li style="display: inline;"><span class="pull-right">Operation:&nbsp;&nbsp;</span></li>
            </ul>
        </div>
        <section class="well noPadding">
            <div class="list">
                <% _.each(model['patch/fail'], function (patch, i) { %>
                    <div class="item clearfix">
                        <span class="desc"><input type="checkbox" id="<%= patch %>" name="patches" value="<%= patch %>" style="margin-bottom: 5px">Patch ID: <%= patch %></span>
                        <span class="pull-right"><a href="#patches/<%= patch %>">More information</a></span>
                    </div>
                <% }); %>
            </div>
        </section>
    </form>
    <% }  else { %>
        <section class="well noPadding">
            <small><em>No patches to display</em></small>
        </section>
    <% } %>
</article>
<script>
    function toggleChecked(el) {
        var status = el.checked,
        form = $(el).parents('form');
       $(form).find(":checkbox").each( function() {
            $(this).attr("checked", status);
        });
    }
    $('form').submit(function (e) {
       var fields = $(this).find('input[name="patches"]:checked');
        if (!fields.length) {
            alert('Please select at least one patch');
            return false;
        }
    });
</script>
<% } %>